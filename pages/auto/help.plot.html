<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<!--  -->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="application/xml+xhtml; charset=UTF-8"/>
<title>enclone help plot</title>
<link href='../enclone.css' rel='stylesheet' type='text/css'>
</head>
<body>
<pre style='font-family: "DejaVuSansMono"; line-height: 110%'><span style="font-size: 14px">
<span style="font-weight:bold;">plotting clonotypes</span>

enclone can create a "honeycomb" plot showing each clonotype as a cluster of dots, one per cell. 
You can see an example at <span style="color:#25bc24;">bit.ly/enclone</span>.

enclone provides four ways to assign colors in such a plot.  We describe them in order of
precedence, i.e. color data for the first will be used if provided, etc.

<span style="color:#c23621;font-weight:bold;">1.</span> The first way is to use the argument
<span style="font-weight:bold;">PLOT="filename,sample1->color1,...,samplen->colorn"</span>
which creates an svg file of the given name, and assigns the given colors to the given samples. 
Unspecified samples will be black.

<span style="color:#c23621;font-weight:bold;">2.</span> The second way is to provide simply
<span style="font-weight:bold;">PLOT=filename</span>
on the command line, and then provide the <span style="font-weight:bold;">color</span> field in the CSV defined by the <span style="font-weight:bold;">META</span> option.  This
assigns a color to each dataset.

<span style="color:#c23621;font-weight:bold;">3.</span> The third way is to use the simple <span style="font-weight:bold;">PLOT</span> specification, and assign a color to each barcode using
the <span style="font-weight:bold;">bc</span> field for <span style="font-weight:bold;">META</span>.

<span style="color:#c23621;font-weight:bold;">4.</span> The fourth way is <span style="font-weight:bold;">PLOT_BY_ISOTYPE=filename</span>.  This plots by heavy chain constant region name and
labels accordingly.  (This only makes sense for BCR.) Some cells may be labeled "unassigned", for
one of three reasons: (1) no heavy chain was found; (2) no constant region was found; (3) two
heavy chains were found and had conflicting constant region names.  Running with <span style="font-weight:bold;">MIN_CHAINS_EXACT=2</span>
is usually a good idea to avoid noise coming from cells for which only a light chain was detected.
 Currently a maximum of 12 constant region names is allowed.  Let us know if you have more and we
will fix this.  Note that <span style="font-weight:bold;">PLOT_BY_ISOTYPE</span> cannot be used with <span style="font-weight:bold;">PLOT</span> or <span style="font-weight:bold;">LEGEND</span>.

The colors should be valid colors for use in an svg file.  They can be named colors like red or
blue (see <span style="color:#25bc24;">https://www.w3.org/TR/SVG11/types.html#ColorKeywords</span> for a full list) or a hex
specification like #00FFFF for aqua.  The full color description for svg is at
<span style="color:#25bc24;">https://www.w3.org/TR/SVGColor12</span>.

enclone also recognizes the color abbreviations @1, ..., @6, which refer to enclone's color blind
friendly palette (see "enclone help color").

Each cell is shown as a disk having the given color, and each clonotype is shown as a cluster of
these disks, which are positioned at random.  We suggest using the <span style="font-weight:bold;">MIN_CELLS</span> option (see "enclone
help filter") so that tiny clonotypes do not dominate.  The filename argument may be "stdout". 
Note that plotting is potentially slow.

To add a legend to the graph, add the argument <span style="font-weight:bold;">LEGEND</span> to your command line.  This will give you an
auto-generated legend.  You can also customize the legend by adding an argument of the form
<span style="font-weight:bold;">LEGEND=color1,"text1",...,colorn,"textn"</span>
to the command line.

</span></pre>
</body>
</html>
